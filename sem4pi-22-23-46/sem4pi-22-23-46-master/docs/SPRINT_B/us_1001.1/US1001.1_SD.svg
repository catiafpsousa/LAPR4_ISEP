<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="725.4px" preserveAspectRatio="none" style="width:1194px;height:725px;background:#FFFFFF;" version="1.1" viewBox="0 0 1194 725" width="1194px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="585.5719" style="stroke:#181818;stroke-width:0.6;" width="6" x="107.4" y="71.1422"/><rect fill="#FFFFFF" height="399.2297" style="stroke:#181818;stroke-width:0.6;" width="6" x="195" y="239.2734"/><rect fill="#FFFFFF" height="18" style="stroke:#181818;stroke-width:0.6;" width="6" x="425.4" y="257.4844"/><rect fill="#FFFFFF" height="326.5969" style="stroke:#181818;stroke-width:0.6;" width="6" x="525.9" y="293.6953"/><rect fill="#FFFFFF" height="92.4656" style="stroke:#181818;stroke-width:0.6;" width="6" x="840.9" y="351.9281"/><rect fill="#FFFFFF" height="58.2328" style="stroke:#181818;stroke-width:0.6;" width="6" x="998.1" y="462.6047"/><rect fill="#FFFFFF" height="36.4219" style="stroke:#181818;stroke-width:0.6;" width="6" x="1083.9" y="539.0484"/><rect fill="#FFFFFF" height="8.4" style="stroke:#181818;stroke-width:0.6;" width="6" x="1159.8" y="593.6813"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="21.6" x2="21.6" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="110.1" x2="110.1" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="198" x2="198" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="428.1" x2="428.1" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="528.9" x2="528.9" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="843.6" x2="843.6" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="931.5" x2="931.5" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="1001.1" x2="1001.1" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="1086.9" x2="1086.9" y1="51.7312" y2="667.5141"/><line style="stroke:#181818;stroke-width:0.3;stroke-dasharray:5.0,5.0;" x1="1162.5" x2="1162.5" y1="51.7312" y2="667.5141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="33.6" x="3" y="49.8855">Manager</text><ellipse cx="21.6" cy="10.2656" fill="#E2E2F0" rx="4.8" ry="4.8" style="stroke:#181818;stroke-width:0.3;"/><path d="M21.6,15.0656 L21.6,31.2656 M13.8,19.8656 L29.4,19.8656 M21.6,31.2656 L13.8,40.2656 M21.6,31.2656 L29.4,40.2656 " fill="none" style="stroke:#181818;stroke-width:0.3;"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="33.6" x="3" y="675.634">Manager</text><ellipse cx="21.6" cy="682.5797" fill="#E2E2F0" rx="4.8" ry="4.8" style="stroke:#181818;stroke-width:0.3;"/><path d="M21.6,687.3797 L21.6,703.5797 M13.8,692.1797 L29.4,692.1797 M21.6,703.5797 L13.8,712.5797 M21.6,703.5797 L29.4,712.5797 " fill="none" style="stroke:#181818;stroke-width:0.3;"/><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="65.4" x="77.7" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="57" x="81.9" y="34.5199">«presentation»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="56.4" x="82.2" y="45.0855">RegisterUserUI</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="65.4" x="77.7" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="57" x="81.9" y="679.834">«presentation»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="56.4" x="82.2" y="690.3996">RegisterUserUI</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="94.8" x="150.6" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="172.8" y="34.5199">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="86.4" x="154.8" y="45.0855">RegisterUserController</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="94.8" x="150.6" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="172.8" y="679.834">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="86.4" x="154.8" y="690.3996">RegisterUserController</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="85.8" x="385.5" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="403.2" y="34.5199">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="77.4" x="389.7" y="45.0855">AuthorizationService</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="85.8" x="385.5" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="403.2" y="679.834">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="77.4" x="389.7" y="690.3996">AuthorizationService</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="103.2" x="477.3" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="503.7" y="34.5199">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="94.8" x="481.5" y="45.0855">UserManagementService</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="103.2" x="477.3" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="50.4" x="503.7" y="679.834">«application»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="94.8" x="481.5" y="690.3996">UserManagementService</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="52.2" x="817.8" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="35.4" x="826.2" y="34.5199">«builder»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="43.8" x="822" y="45.0855">UserBuilder</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="52.2" x="817.8" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="35.4" x="826.2" y="679.834">«builder»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="43.8" x="822" y="690.3996">UserBuilder</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="45.6" x="908.7" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="37.2" x="912.9" y="34.5199">«domain»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="36.6" x="913.2" y="45.0855">user:User</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="45.6" x="908.7" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="37.2" x="912.9" y="679.834">«domain»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="36.6" x="913.2" y="690.3996">user:User</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="81.6" x="960.3" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="53.4" x="974.4" y="34.5199">«persistence»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="73.2" x="964.5" y="45.0855">PersistenceContext</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="81.6" x="960.3" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="53.4" x="974.4" y="679.834">«persistence»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="73.2" x="964.5" y="690.3996">PersistenceContext</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="78" x="1047.9" y="21.6"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="35.4" x="1069.2" y="34.5199">«factory»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="69.6" x="1052.1" y="45.0855">RepositoryFactory</text><rect fill="#E2E2F0" height="29.5313" rx="1.5" ry="1.5" style="stroke:#181818;stroke-width:0.3;" width="78" x="1047.9" y="666.9141"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="35.4" x="1069.2" y="679.834">«factory»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="69.6" x="1052.1" y="690.3996">RepositoryFactory</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="47.4" x="1137.3" y="39.3199">«repository»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="58.2" x="1131.9" y="49.8855">UserRepository</text><path d="M1152,9 C1152,3 1162.8,3 1162.8,3 C1162.8,3 1173.6,3 1173.6,9 L1173.6,24.6 C1173.6,30.6 1162.8,30.6 1162.8,30.6 C1162.8,30.6 1152,30.6 1152,24.6 L1152,9 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.8999999999999999;"/><path d="M1152,9 C1152,15 1162.8,15 1162.8,15 C1162.8,15 1173.6,15 1173.6,9 " fill="none" style="stroke:#181818;stroke-width:0.8999999999999999;"/><text fill="#000000" font-family="FG Virgil" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="47.4" x="1137.3" y="675.634">«repository»</text><text fill="#000000" font-family="FG Virgil" font-size="8.4" lengthAdjust="spacing" textLength="58.2" x="1131.9" y="686.1996">UserRepository</text><path d="M1152,694.0453 C1152,688.0453 1162.8,688.0453 1162.8,688.0453 C1162.8,688.0453 1173.6,688.0453 1173.6,694.0453 L1173.6,709.6453 C1173.6,715.6453 1162.8,715.6453 1162.8,715.6453 C1162.8,715.6453 1152,715.6453 1152,709.6453 L1152,694.0453 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.8999999999999999;"/><path d="M1152,694.0453 C1152,700.0453 1162.8,700.0453 1162.8,700.0453 C1162.8,700.0453 1173.6,700.0453 1173.6,694.0453 " fill="none" style="stroke:#181818;stroke-width:0.8999999999999999;"/><rect fill="#FFFFFF" height="585.5719" style="stroke:#181818;stroke-width:0.6;" width="6" x="107.4" y="71.1422"/><rect fill="#FFFFFF" height="399.2297" style="stroke:#181818;stroke-width:0.6;" width="6" x="195" y="239.2734"/><rect fill="#FFFFFF" height="18" style="stroke:#181818;stroke-width:0.6;" width="6" x="425.4" y="257.4844"/><rect fill="#FFFFFF" height="326.5969" style="stroke:#181818;stroke-width:0.6;" width="6" x="525.9" y="293.6953"/><rect fill="#FFFFFF" height="92.4656" style="stroke:#181818;stroke-width:0.6;" width="6" x="840.9" y="351.9281"/><rect fill="#FFFFFF" height="58.2328" style="stroke:#181818;stroke-width:0.6;" width="6" x="998.1" y="462.6047"/><rect fill="#FFFFFF" height="36.4219" style="stroke:#181818;stroke-width:0.6;" width="6" x="1083.9" y="539.0484"/><rect fill="#FFFFFF" height="8.4" style="stroke:#181818;stroke-width:0.6;" width="6" x="1159.8" y="593.6813"/><polygon fill="#181818" points="100.2,68.7422,106.2,71.1422,100.2,73.5422,102.6,71.1422" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="21.6" x2="103.8" y1="71.1422" y2="71.1422"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="47.4" x="25.8" y="68.2283">Register User</text><polygon fill="#181818" points="190.8,86.9531,196.8,89.3531,190.8,91.7531,193.2,89.3531" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="113.4" x2="194.4" y1="89.3531" y2="89.3531"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="21.6" x="117.6" y="86.4393">create</text><polygon fill="#181818" points="28.2,105.1641,22.2,107.5641,28.2,109.9641,25.8,107.5641" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="24.6" x2="106.8" y1="107.5641" y2="107.5641"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="71.4" x="31.8" y="104.6502">Ask user information</text><polygon fill="#181818" points="100.2,142.9969,106.2,145.3969,100.2,147.7969,102.6,145.3969" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="21.6" x2="103.8" y1="145.3969" y2="145.3969"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="61.2" x="25.8" y="122.8611">Email, Password,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="37.8" x="25.8" y="132.6721">Full Name,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="41.4" x="25.8" y="142.483">Short Name</text><polygon fill="#181818" points="28.2,171.0187,22.2,173.4188,28.2,175.8188,25.8,173.4188" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="24.6" x2="106.8" y1="173.4188" y2="173.4188"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="34.2" x="31.8" y="160.6939">Show List</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="47.4" x="31.8" y="170.5049">of Role Types</text><polygon fill="#181818" points="100.2,189.2297,106.2,191.6297,100.2,194.0297,102.6,191.6297" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="21.6" x2="103.8" y1="191.6297" y2="191.6297"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="34.8" x="25.8" y="188.7158">Role Type</text><polygon fill="#181818" points="187.8,236.8734,193.8,239.2734,187.8,241.6734,190.2,239.2734" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="113.4" x2="191.4" y1="239.2734" y2="239.2734"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="52.2" x="117.6" y="206.9268">addUser(email,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="70.2" x="117.6" y="216.7377">password, fullName,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="40.2" x="117.6" y="226.5486">shortName,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="19.2" x="117.6" y="236.3596">roles)</text><polygon fill="#181818" points="418.2,255.0844,424.2,257.4844,418.2,259.8844,420.6,257.4844" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="201" x2="421.8" y1="257.4844" y2="257.4844"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="213" x="205.2" y="254.5705">ensureAuthenticatedUserHasAnyOf(ADMIN, POWER_USER)</text><polygon fill="#181818" points="518.7,291.2953,524.7,293.6953,518.7,296.0953,521.1,293.6953" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="201" x2="522.3" y1="293.6953" y2="293.6953"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="260.4" x="205.2" y="290.7814">registerNewUser (email, password, fullName, shortName, roles, createdOn)</text><polygon fill="#181818" points="836.7,309.5062,842.7,311.9063,836.7,314.3063,839.1,311.9063" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="531.9" x2="840.3" y1="311.9063" y2="311.9063"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="21.6" x="536.1" y="308.9924">create</text><path d="M846.6,319.7063 L846.6,335.3063 L1122.6,335.3063 L1122.6,325.7063 L1116.6,319.7063 L846.6,319.7063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3;"/><path d="M1116.6,319.7063 L1116.6,325.7063 L1122.6,325.7063 L1116.6,319.7063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3;"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="263.4" x="850.2" y="330.8033">UserBuilder é usado para criar uma entidade do tipo User num estado válido</text><polygon fill="#181818" points="833.7,349.5281,839.7,351.9281,833.7,354.3281,836.1,351.9281" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="531.9" x2="837.3" y1="351.9281" y2="351.9281"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="297.6" x="536.1" y="349.0143">with(email,rawPassword, fullName,shortName).createdOn(createdOn).withRoles(roles)</text><polygon fill="#181818" points="833.7,367.7391,839.7,370.1391,833.7,372.5391,836.1,370.1391" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="531.9" x2="837.3" y1="370.1391" y2="370.1391"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="21" x="536.1" y="367.2252">build()</text><polygon fill="#181818" points="924.3,405.5719,930.3,407.9719,924.3,410.3719,926.7,407.9719" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="846.9" x2="927.9" y1="407.9719" y2="407.9719"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="47.4" x="851.1" y="385.4361">create (email,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="70.2" x="851.1" y="395.2471">password, fullName,</text><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="61.8" x="851.1" y="405.058">shortName, roles)</text><polygon fill="#181818" points="853.5,423.7828,847.5,426.1828,853.5,428.5828,851.1,426.1828" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="849.9" x2="930.9" y1="426.1828" y2="426.1828"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="15" x="857.1" y="423.2689">user</text><polygon fill="#181818" points="538.5,441.9938,532.5,444.3938,538.5,446.7938,536.1,444.3938" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="534.9" x2="843.3" y1="444.3938" y2="444.3938"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="15" x="542.1" y="441.4799">user</text><polygon fill="#181818" points="990.9,460.2047,996.9,462.6047,990.9,465.0047,993.3,462.6047" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="531.9" x2="994.5" y1="462.6047" y2="462.6047"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="45" x="536.1" y="459.6908">repositories()</text><path d="M1006.8,470.4047 L1006.8,486.0047 L1165.2,486.0047 L1165.2,476.4047 L1159.2,470.4047 L1006.8,470.4047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3;"/><path d="M1159.2,470.4047 L1159.2,476.4047 L1165.2,476.4047 L1159.2,470.4047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3;"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="145.8" x="1010.4" y="481.5018">pode criar repositório em memória ou JPA</text><polygon fill="#181818" points="1079.7,500.2266,1085.7,502.6266,1079.7,505.0266,1082.1,502.6266" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="1004.1" x2="1083.3" y1="502.6266" y2="502.6266"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="21.6" x="1008.3" y="499.7127">create</text><polygon fill="#181818" points="538.5,518.4375,532.5,520.8375,538.5,523.2375,536.1,520.8375" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="534.9" x2="1000.5" y1="520.8375" y2="520.8375"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="23.4" x="542.1" y="517.9236">factory</text><polygon fill="#181818" points="1076.7,536.6484,1082.7,539.0484,1076.7,541.4484,1079.1,539.0484" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="531.9" x2="1080.3" y1="539.0484" y2="539.0484"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="24" x="536.1" y="536.1346">users()</text><polygon fill="#181818" points="1155.6,554.8594,1161.6,557.2594,1155.6,559.6594,1158,557.2594" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="1089.9" x2="1159.2" y1="557.2594" y2="557.2594"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="21.6" x="1094.1" y="554.3455">create</text><polygon fill="#181818" points="538.5,573.0703,532.5,575.4703,538.5,577.8703,536.1,575.4703" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="534.9" x2="1086.3" y1="575.4703" y2="575.4703"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="52.2" x="542.1" y="572.5564">userRepository</text><polygon fill="#181818" points="1152.6,591.2813,1158.6,593.6813,1152.6,596.0813,1155,593.6813" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;" x1="531.9" x2="1156.2" y1="593.6813" y2="593.6813"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="35.4" x="536.1" y="590.7674">save(user)</text><polygon fill="#181818" points="538.5,599.6813,532.5,602.0813,538.5,604.4812,536.1,602.0813" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="534.9" x2="1162.2" y1="602.0813" y2="602.0813"/><polygon fill="#181818" points="207.6,617.8922,201.6,620.2922,207.6,622.6922,205.2,620.2922" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="204" x2="528.3" y1="620.2922" y2="620.2922"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="15" x="211.2" y="617.3783">user</text><polygon fill="#181818" points="120,636.1031,114,638.5031,120,640.9031,117.6,638.5031" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="116.4" x2="197.4" y1="638.5031" y2="638.5031"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="15" x="123.6" y="635.5893">user</text><polygon fill="#181818" points="28.2,654.3141,22.2,656.7141,28.2,659.1141,25.8,656.7141" style="stroke:#181818;stroke-width:0.6;"/><line style="stroke:#181818;stroke-width:0.6;stroke-dasharray:2.0,2.0;" x1="24.6" x2="109.8" y1="656.7141" y2="656.7141"/><text fill="#000000" font-family="FG Virgil" font-size="7.8" lengthAdjust="spacing" textLength="52.8" x="31.8" y="653.8002">displayUserInfo</text><!--MD5=[36566847f27072281e19dfa2e83c7efa]
@startuml
'http://plantuml.com/skinparam.html
skinparam handwritten false
skinparam packageStyle rect
skinparam defaultFontName FG Virgil
skinparam shadowing false

actor Manager as Actor
participant RegisterUserUI as UI <<presentation>>
participant RegisterUserController as Controller <<application>>
participant AuthorizationService  as authz <<application>>
participant UserManagementService as userSvc <<application>>

participant UserBuilder as Builder <<builder>>
participant "user:User" as Domain <<domain>>
participant PersistenceContext as Persistence <<persistence>>
participant RepositoryFactory as Factory <<factory>>
database UserRepository as Repository <<repository>>

Actor - -> UI: Register User
activate UI
    UI - -> Controller: create
    UI - -> Actor: Ask user information
    Actor - -> UI: Email, Password,\nFull Name,\nShort Name


        UI - -> Actor: Show List\nof Role Types
        Actor - -> UI: Role Type

    UI -> Controller: addUser(email, \npassword, fullName,\nshortName, \nroles)
    activate Controller

        Controller -> authz: ensureAuthenticatedUserHasAnyOf(ADMIN, POWER_USER)
        activate authz
        deactivate authz
        Controller -> userSvc : registerNewUser (email, password, fullName, shortName, roles, createdOn)
        activate userSvc


        userSvc - -> Builder: create


         note right of Builder:UserBuilder é usado para criar uma entidade do tipo User num estado válido

        userSvc -> Builder:with(email,rawPassword, fullName,shortName).createdOn(createdOn).withRoles(roles)
        activate Builder
        userSvc -> Builder:build()

            Builder -> Domain: create (email,\npassword, fullName,\nshortName, roles)
            Domain->Builder: user
            Builder -> userSvc:user
        deactivate Builder
          userSvc -> Persistence: repositories()



        activate Persistence
            note right of Persistence: pode criar repositório em memória ou JPA
            Persistence - -> Factory: create
            Persistence -> userSvc: factory
        deactivate Persistence

        userSvc -> Factory: users()
        activate Factory
            Factory - -> Repository: create
            Factory - -> userSvc: userRepository

        deactivate Factory

        userSvc->Repository:save(user)
         activate Repository



         Repository - -> userSvc
         deactivate Repository
         userSvc - -> Controller : user
         deactivate userSvc
        Controller- ->UI: user
    deactivate Controller

        UI- ->Actor: displayUserInfo
deactivate UI
@enduml

@startuml
skinparam handwritten false
skinparam packageStyle rect
skinparam defaultFontName FG Virgil
skinparam shadowing false

actor Manager as Actor
participant RegisterUserUI as UI <<presentation>>
participant RegisterUserController as Controller <<application>>
participant AuthorizationService  as authz <<application>>
participant UserManagementService as userSvc <<application>>

participant UserBuilder as Builder <<builder>>
participant "user:User" as Domain <<domain>>
participant PersistenceContext as Persistence <<persistence>>
participant RepositoryFactory as Factory <<factory>>
database UserRepository as Repository <<repository>>

Actor - -> UI: Register User
activate UI
    UI - -> Controller: create
    UI - -> Actor: Ask user information
    Actor - -> UI: Email, Password,\nFull Name,\nShort Name


        UI - -> Actor: Show List\nof Role Types
        Actor - -> UI: Role Type

    UI -> Controller: addUser(email, \npassword, fullName,\nshortName, \nroles)
    activate Controller

        Controller -> authz: ensureAuthenticatedUserHasAnyOf(ADMIN, POWER_USER)
        activate authz
        deactivate authz
        Controller -> userSvc : registerNewUser (email, password, fullName, shortName, roles, createdOn)
        activate userSvc


        userSvc - -> Builder: create


         note right of Builder:UserBuilder é usado para criar uma entidade do tipo User num estado válido

        userSvc -> Builder:with(email,rawPassword, fullName,shortName).createdOn(createdOn).withRoles(roles)
        activate Builder
        userSvc -> Builder:build()

            Builder -> Domain: create (email,\npassword, fullName,\nshortName, roles)
            Domain->Builder: user
            Builder -> userSvc:user
        deactivate Builder
          userSvc -> Persistence: repositories()



        activate Persistence
            note right of Persistence: pode criar repositório em memória ou JPA
            Persistence - -> Factory: create
            Persistence -> userSvc: factory
        deactivate Persistence

        userSvc -> Factory: users()
        activate Factory
            Factory - -> Repository: create
            Factory - -> userSvc: userRepository

        deactivate Factory

        userSvc->Repository:save(user)
         activate Repository



         Repository - -> userSvc
         deactivate Repository
         userSvc - -> Controller : user
         deactivate userSvc
        Controller- ->UI: user
    deactivate Controller

        UI- ->Actor: displayUserInfo
deactivate UI
@enduml

PlantUML version 1.2022.12(Sun Oct 23 19:12:26 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>